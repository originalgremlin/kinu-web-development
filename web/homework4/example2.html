<!doctype html>
<html>
<head>
	<script src="../scripts/lib/underscore.js"></script>
	<script src="../scripts/lib/jquery.js"></script>
	<script src="../scripts/lib/backbone.js"></script>
	<script src="../scripts/lib/backbone.marionette.js"></script>
	<script>_.templateSettings = { interpolate: /\{\{(.+?)\}\}/g };</script>

	<!-- TODO: convert this to a form with inputs -->
	<script type="text/template" id="template-employee">
		<p>Title: {{ title }}</p>
		<p>Full Name: {{ name }}</p>
		<p>Date of Birth: {{ birthdate }}</p>
		<p>Gender: {{ gender }}</p>
		<p>Phone Number: {{ phonenumber }}</p>
		<p>Phisical Address: {{ address }}</p>
		<p>E-Mail: {{ email }}</p>
		<p>Basic Qualification: {{ qualification }}</p>
		<p>Past Experiance: {{ pastexperiance }}</p>
		<p>Designation: {{ designation }}</p>
		<p>Basic Salary: {{ basicsalary }}</p>
		<p>Department: {{ department }}</p>
		<p>Remarks: {{ remarks }}</p>
		<button>Click to save</button>
	</script>
	

	<script>
	// TODO: expand the model to include phone number, email, etc.
	// http://backbonejs.org/#Model-defaults
	var EmployeeModel = Backbone.Model.extend({
		urlRoot: '/api/kazifasta',
		defaults: {
			title: '',
			name: '',
			birthdate: [2000, 1, 1],
			gender: '',
			phonenumber: '',
			address:'',
			email: '',
			qualification: '',
			pastexperiance: '',
			designation: '',
			basicsalary: '',
			department: '',
			remarks: ''
		}
	});

	var EmployeeView = Backbone.Marionette.ItemView.extend({
		events: {
			'click button': 'onClick'
		},
		template: '#template-employee',

		onClick: function (event) {
			// TODO: get data from the form inputs
			// http://api.jquery.com/val/

			// TODO: put form data in the model
			// http://backbonejs.org/#Model-set
			var emp = new EmployeeModel({
				title: $("#title").val(),
				name: $("#name").val(),
				birthdate: [$("#year").val(), $("#month").val(), $("#day").val()],
				gender: $("#ge nder").val(),
				phonenumber: $("#phonenumber").val(),
				address:$("#address").val(),
				email: $("#email").val(),
				qualification: $("#qualification").val(),
				pastexperiance: $("#pastexperience").val(),
				designation: $("#designation").val(),
				basicsalary: $("#basicsalary").val(),
				department: $("#department").val(),
				remarks: $("#remarks").val()
			});
			

			// TODO: save the model to the database
			// http://backbonejs.org/#Model-save
			emp.save();
			
			
		}
	});

	$('document').ready(function () {
		var m = new EmployeeModel({
			title: 'Mr',
			name: 'Leonard Nyirenda',
			birthdate: [1983, 2, 28],
			gender: 'Male',
			phonenumber: '255757447737',
			address:'p.o.box 511 Dar-es-salaam, Tanzania',
			email: 'nyirendalen@gmail.com',
			qualification: '',
			pastexperiance: '4yrs',
			designation: 'Coder',
			basicsalary: '$200',
			department: 'Computing',
			remarks: 'Just testing'
		});

		// Marionette View instance
		var v = new EmployeeView({
			el: '#employee',
			model: m
		});
		v.render();
	});
	</script>
</head>

<body>
	<div id="employee"></div>
</body>
</html>